import{_ as s,o as a,c as n,Q as e}from"./chunks/framework.7cd3ab18.js";const b=JSON.parse('{"title":"Types","description":"","frontmatter":{},"headers":[],"relativePath":"integrated-jule/interoperability/types.md","filePath":"integrated-jule/interoperability/types.md"}'),p={name:"integrated-jule/interoperability/types.md"},l=e(`<h1 id="types" tabindex="-1">Types <a class="header-anchor" href="#types" aria-label="Permalink to &quot;Types&quot;">​</a></h1><h2 id="linking-types" tabindex="-1">Linking Types <a class="header-anchor" href="#linking-types" aria-label="Permalink to &quot;Linking Types&quot;">​</a></h2><p>Although it is possible to link any typedef, these type aliases are not like standard aliases, for example they cannot be used as an alias for a struct if you use them in an expression. These type aliases are for linking unavoidable types to Jule.</p><p>For example:</p><div class="language-jule line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jule</span><pre class="shiki github-dark"><code><span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> char: </span><span style="color:#F97583;">byte</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>If the types you use do not belong to Jule, if you are linking from C/C++, make sure to use the types you link, even if you have a compatible Jule type. This is important for your type safety.</p></div><h2 id="linking-type-aliases" tabindex="-1">Linking Type Aliases <a class="header-anchor" href="#linking-type-aliases" aria-label="Permalink to &quot;Linking Type Aliases&quot;">​</a></h2><p>Type alias linking is the same as type linking.</p><p>For example:</p><div class="language-jule line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jule</span><pre class="shiki github-dark"><code><span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> char: </span><span style="color:#F97583;">byte</span></span>
<span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> CPTR: </span><span style="color:#F97583;">*cpp</span><span style="color:#E1E4E8;">.char</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="type-safety" tabindex="-1">Type Safety <a class="header-anchor" href="#type-safety" aria-label="Permalink to &quot;Type Safety&quot;">​</a></h2><p>For type safety reasons, linked types are only compatible with linked types. Cannot be used directly with any Jule type. For example, you cannot assign a <code>byte</code> type to a linked <code>char</code> type, or vice versa, even if you have linked the <code>char</code> type as <code>byte</code>. To do this, if you have linked with a compatible type, you can cast it.</p><p>For example:</p><div class="language-jule line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jule</span><pre class="shiki github-dark"><code><span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> char: </span><span style="color:#F97583;">byte</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">get_char</span><span style="color:#E1E4E8;">(): </span><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;">.char</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> b: </span><span style="color:#F97583;">byte</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">byte</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">get_char</span><span style="color:#E1E4E8;">())</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">outln</span><span style="color:#E1E4E8;">(b)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The above code should execute without problems, but removing casting will result in a compiler error regarding type safety.</p><h3 id="why-do-we-need-this-safety" tabindex="-1">Why do we need this safety? <a class="header-anchor" href="#why-do-we-need-this-safety" aria-label="Permalink to &quot;Why do we need this safety?&quot;">​</a></h3><p>To achieve full compatibility with C types, your compiler encourages you to use only those types. There is an important and simple reason for this: type safety. Even if they are fully compatible, if your compiler treated them like Jule types, it would be easier to get compiler errors and you would run into various problems.</p><p>For example:</p><div class="language-jule line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jule</span><pre class="shiki github-dark"><code><span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> char: </span><span style="color:#F97583;">byte</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">unsafe</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">printf</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">*cpp</span><span style="color:#E1E4E8;">.char)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">cprint</span><span style="color:#E1E4E8;">(s: </span><span style="color:#F97583;">str</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">unsafe</span><span style="color:#E1E4E8;"> { </span><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">printf</span><span style="color:#E1E4E8;">((</span><span style="color:#F97583;">*cpp</span><span style="color:#E1E4E8;">.char)(</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">s[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">])) }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">cprint</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Hello World</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>The code above prevents you from passing the <code>*byte</code> type directly to <code>*cpp.char</code> as your compiler encourages you to be safe. This is an important incentive to make the generated IR compilable. If your compiler didn&#39;t do this and considered it compatible, the backend-compiler would have told you that the type <code>jule::U8*</code> and <code>char*</code> are not compatible.</p><h2 id="type-compatibility" tabindex="-1">Type Compatibility <a class="header-anchor" href="#type-compatibility" aria-label="Permalink to &quot;Type Compatibility&quot;">​</a></h2><p>There is no direct compatibility between Jule types and C/C++ types. Definitions within the Jule API may exhibit automatic conversion to C/C++ types and therefore these types can be used directly with each other. But it is a poorly tested and unreliable method. To give an example of type conversion, the API&#39;s <code>jule::Str</code> i.e. <code>str</code> type in Jule can often be used with C++&#39;s <code>std::string</code> type and C&#39;s <code>char*</code> type.</p><p>For example:</p><p>C++ class:</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MyClass</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">public:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">std</span><span style="color:#E1E4E8;">::string data;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">std</span><span style="color:#E1E4E8;">::string magic_data;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">char</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">c_data;</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Jule code:</p><div class="language-jule line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">jule</span><pre class="shiki github-dark"><code><span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;myclass.hpp&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">#typedef</span></span>
<span class="line"><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> MyClass {</span></span>
<span class="line"><span style="color:#E1E4E8;">    data: </span><span style="color:#F97583;">str</span></span>
<span class="line"><span style="color:#E1E4E8;">    magic_data: </span><span style="color:#F97583;">str</span></span>
<span class="line"><span style="color:#E1E4E8;">    c_data: </span><span style="color:#F97583;">str</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">main</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> mc </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">cpp</span><span style="color:#E1E4E8;">.MyClass{</span></span>
<span class="line"><span style="color:#E1E4E8;">        data: </span><span style="color:#9ECBFF;">&quot;my data&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        magic_data: </span><span style="color:#9ECBFF;">&quot;hello world&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        c_data: </span><span style="color:#9ECBFF;">&quot;hello c strings&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">outln</span><span style="color:#E1E4E8;">(mc.data)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">outln</span><span style="color:#E1E4E8;">(mc.magic_data)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">outln</span><span style="color:#E1E4E8;">(mc.c_data)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>In the above example, your compiler does not detect the types of fields of the linked class and generates code accordingly, your compiler behaves as it always does. The generated code works in harmony with each other as it can be converted automatically.</p><p>While this type compatibility may work well with most primitive types such as <code>bool</code>, <code>str</code>, and arithmetic data types, we always recommend writing a wrapper for existing C++ classes or etc.</p><p>See <a href="/api/integrated-jule/wrappers.html">wrappers</a> section of API manual.</p>`,30),o=[l];function t(r,c,i,y,E,d){return a(),n("div",null,o)}const m=s(p,[["render",t]]);export{b as __pageData,m as default};
